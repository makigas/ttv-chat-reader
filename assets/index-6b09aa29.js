var vn=Object.defineProperty;var wn=(e,t,n)=>t in e?vn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var me=(e,t,n)=>(wn(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function N(){}function Kt(e){return e()}function Ke(){return Object.create(null)}function ee(e){e.forEach(Kt)}function Yt(e){return typeof e=="function"}function ye(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function On(e){return Object.keys(e).length===0}function Sn(e,...t){if(e==null)return N;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function $n(e,t,n){e.$$.on_destroy.push(Sn(t,n))}function x(e,t){e.appendChild(t)}function le(e,t,n){e.insertBefore(t,n||null)}function te(e){e.parentNode&&e.parentNode.removeChild(e)}function L(e){return document.createElement(e)}function se(e){return document.createTextNode(e)}function ne(){return se(" ")}function Ye(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function P(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Tn(e){return Array.from(e.childNodes)}function Te(e,t){t=""+t,e.data!==t&&(e.data=t)}function Qe(e,t,n,r){n===null?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}let oe;function re(e){oe=e}function Qt(){if(!oe)throw new Error("Function called outside component initialization");return oe}function Xt(e){Qt().$$.on_mount.push(e)}function kn(e){Qt().$$.on_destroy.push(e)}const K=[],Xe=[];let Q=[];const Ze=[],Cn=Promise.resolve();let ke=!1;function Pn(){ke||(ke=!0,Cn.then(Zt))}function Ce(e){Q.push(e)}const we=new Set;let H=0;function Zt(){if(H!==0)return;const e=oe;do{try{for(;H<K.length;){const t=K[H];H++,re(t),En(t.$$)}}catch(t){throw K.length=0,H=0,t}for(re(null),K.length=0,H=0;Xe.length;)Xe.pop()();for(let t=0;t<Q.length;t+=1){const n=Q[t];we.has(n)||(we.add(n),n())}Q.length=0}while(K.length);for(;Ze.length;)Ze.pop()();ke=!1,we.clear(),re(e)}function En(e){if(e.fragment!==null){e.update(),ee(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Ce)}}function xn(e){const t=[],n=[];Q.forEach(r=>e.indexOf(r)===-1?t.push(r):n.push(r)),n.forEach(r=>r()),Q=t}const de=new Set;let z;function An(){z={r:0,c:[],p:z}}function Ln(){z.r||ee(z.c),z=z.p}function Z(e,t){e&&e.i&&(de.delete(e),e.i(t))}function ie(e,t,n,r){if(e&&e.o){if(de.has(e))return;de.add(e),z.c.push(()=>{de.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}const Nn=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"];[...Nn];function en(e){e&&e.c()}function Je(e,t,n,r){const{fragment:s,after_update:o}=e.$$;s&&s.m(t,n),r||Ce(()=>{const c=e.$$.on_mount.map(Kt).filter(Yt);e.$$.on_destroy?e.$$.on_destroy.push(...c):ee(c),e.$$.on_mount=[]}),o.forEach(Ce)}function He(e,t){const n=e.$$;n.fragment!==null&&(xn(n.after_update),ee(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function jn(e,t){e.$$.dirty[0]===-1&&(K.push(e),Pn(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Ve(e,t,n,r,s,o,c,a=[-1]){const m=oe;re(e);const h=e.$$={fragment:null,ctx:[],props:o,update:N,not_equal:s,bound:Ke(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(m?m.$$.context:[])),callbacks:Ke(),dirty:a,skip_bound:!1,root:t.target||m.$$.root};c&&c(h.root);let f=!1;if(h.ctx=n?n(e,t.props||{},(w,b,...y)=>{const l=y.length?y[0]:b;return h.ctx&&s(h.ctx[w],h.ctx[w]=l)&&(!h.skip_bound&&h.bound[w]&&h.bound[w](l),f&&jn(e,w)),b}):[],h.update(),f=!0,ee(h.before_update),h.fragment=r?r(h.ctx):!1,t.target){if(t.hydrate){const w=Tn(t.target);h.fragment&&h.fragment.l(w),w.forEach(te)}else h.fragment&&h.fragment.c();t.intro&&Z(e.$$.fragment),Je(e,t.target,t.anchor,t.customElement),Zt()}re(m)}class Ge{$destroy(){He(this,1),this.$destroy=N}$on(t,n){if(!Yt(n))return N;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(t){this.$$set&&!On(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var et=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function In(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){if(this instanceof r){var s=[null];s.push.apply(s,arguments);var o=Function.bind.apply(t,s);return new o}return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}),n}var tn={exports:{}};const Rn={},Dn=Object.freeze(Object.defineProperty({__proto__:null,default:Rn},Symbol.toStringTag,{value:"Module"})),Pe=In(Dn);var nn={exports:{}};const Fn=/^\u0001ACTION ([^\u0001]+)\u0001$/,Un=/^(justinfan)(\d+$)/,zn=/\\([sn:r\\])/g,qn=/([ \n;\r\\])/g,tt={s:" ",n:"",":":";",r:""},nt={" ":"s","\n":"n",";":":","\r":"r"},Jn=new RegExp("^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$","i"),Hn=/[|\\^$*+?:#]/,he=nn.exports={get:(e,t)=>typeof e>"u"?t:e,hasOwn:(e,t)=>({}).hasOwnProperty.call(e,t),promiseDelay:e=>new Promise(t=>setTimeout(t,e)),isFinite:e=>isFinite(e)&&!isNaN(parseFloat(e)),toNumber(e,t){if(e===null)return 0;const n=Math.pow(10,he.isFinite(t)?t:0);return Math.round(e*n)/n},isInteger:e=>!isNaN(he.toNumber(e,0)),isRegex:e=>Hn.test(e),isURL:e=>Jn.test(e),justinfan:()=>`justinfan${Math.floor(Math.random()*8e4+1e3)}`,isJustinfan:e=>Un.test(e),channel(e){const t=(e||"").toLowerCase();return t[0]==="#"?t:"#"+t},username(e){const t=(e||"").toLowerCase();return t[0]==="#"?t.slice(1):t},token:e=>e?e.toLowerCase().replace("oauth:",""):"",password(e){const t=he.token(e);return t?`oauth:${t}`:""},actionMessage:e=>e.match(Fn),replaceAll(e,t){if(e===null||typeof e>"u")return null;for(const n in t)e=e.replace(new RegExp(n,"g"),t[n]);return e},unescapeHtml:e=>e.replace(/\\&amp\\;/g,"&").replace(/\\&lt\\;/g,"<").replace(/\\&gt\\;/g,">").replace(/\\&quot\\;/g,'"').replace(/\\&#039\\;/g,"'"),unescapeIRC(e){return!e||typeof e!="string"||!e.includes("\\")?e:e.replace(zn,(t,n)=>n in tt?tt[n]:n)},escapeIRC(e){return!e||typeof e!="string"?e:e.replace(qn,(t,n)=>n in nt?`\\${nt[n]}`:n)},addWord:(e,t)=>e.length?e+" "+t:e+t,splitLine(e,t){let n=e.substring(0,t).lastIndexOf(" ");return n===-1&&(n=t-1),[e.substring(0,n),e.substring(n+1)]},extractNumber(e){const t=e.split(" ");for(let n=0;n<t.length;n++)if(he.isInteger(t[n]))return~~t[n];return 0},formatDate(e){let t=e.getHours(),n=e.getMinutes();return t=(t<10?"0":"")+t,n=(n<10?"0":"")+n,`${t}:${n}`},inherits(e,t){e.super_=t;const n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},isNode(){try{return typeof process=="object"&&Object.prototype.toString.call(process)==="[object process]"}catch{}return!1}};var fe=nn.exports;const Vn=Pe,rt=fe;var Gn=function(t,n){let r=t.url!==void 0?t.url:t.uri;if(rt.isURL(r)||(r=`https://api.twitch.tv/kraken${r[0]==="/"?r:`/${r}`}`),rt.isNode()){const s=Object.assign({method:"GET",json:!0},t);if(s.qs){const m=new URLSearchParams(s.qs);r+=`?${m}`}const o={};"fetchAgent"in this.opts.connection&&(o.agent=this.opts.connection.fetchAgent);const c=Vn(r,{...o,method:s.method,headers:s.headers,body:s.body});let a={};c.then(m=>(a={statusCode:m.status,headers:m.headers},s.json?m.json():m.text())).then(m=>n(null,a,m),m=>n(m,a,null))}else{const s=Object.assign({method:"GET",headers:{}},t,{url:r}),o=new XMLHttpRequest;o.open(s.method,s.url,!0);for(const c in s.headers)o.setRequestHeader(c,s.headers[c]);o.responseType="json",o.addEventListener("load",c=>{o.readyState===4&&(o.status!==200?n(o.status,null,null):n(null,null,o.response))}),o.send()}};const v=fe;function st(e,t){return e=v.channel(e),t=v.get(t,30),this._sendCommand(null,e,`/followers ${t}`,(n,r)=>{this.once("_promiseFollowers",s=>{s?r(s):n([e,~~t])})})}function ot(e){return e=v.channel(e),this._sendCommand(null,e,"/followersoff",(t,n)=>{this.once("_promiseFollowersoff",r=>{r?n(r):t([e])})})}function it(e){return e=v.channel(e),this._sendCommand(null,null,`PART ${e}`,(t,n)=>{this.once("_promisePart",r=>{r?n(r):t([e])})})}function at(e){return e=v.channel(e),this._sendCommand(null,e,"/r9kbeta",(t,n)=>{this.once("_promiseR9kbeta",r=>{r?n(r):t([e])})})}function ut(e){return e=v.channel(e),this._sendCommand(null,e,"/r9kbetaoff",(t,n)=>{this.once("_promiseR9kbetaoff",r=>{r?n(r):t([e])})})}function ct(e,t){return e=v.channel(e),t=v.get(t,300),this._sendCommand(null,e,`/slow ${t}`,(n,r)=>{this.once("_promiseSlow",s=>{s?r(s):n([e,~~t])})})}function lt(e){return e=v.channel(e),this._sendCommand(null,e,"/slowoff",(t,n)=>{this.once("_promiseSlowoff",r=>{r?n(r):t([e])})})}var Wn={action(e,t){return e=v.channel(e),t=`ACTION ${t}`,this._sendMessage(this._getPromiseDelay(),e,t,(n,r)=>{n([e,t])})},ban(e,t,n){return e=v.channel(e),t=v.username(t),n=v.get(n,""),this._sendCommand(null,e,`/ban ${t} ${n}`,(r,s)=>{this.once("_promiseBan",o=>{o?s(o):r([e,t,n])})})},clear(e){return e=v.channel(e),this._sendCommand(null,e,"/clear",(t,n)=>{this.once("_promiseClear",r=>{r?n(r):t([e])})})},color(e,t){return t=v.get(t,e),this._sendCommand(null,"#tmijs",`/color ${t}`,(n,r)=>{this.once("_promiseColor",s=>{s?r(s):n([t])})})},commercial(e,t){return e=v.channel(e),t=v.get(t,30),this._sendCommand(null,e,`/commercial ${t}`,(n,r)=>{this.once("_promiseCommercial",s=>{s?r(s):n([e,~~t])})})},deletemessage(e,t){return e=v.channel(e),this._sendCommand(null,e,`/delete ${t}`,(n,r)=>{this.once("_promiseDeletemessage",s=>{s?r(s):n([e])})})},emoteonly(e){return e=v.channel(e),this._sendCommand(null,e,"/emoteonly",(t,n)=>{this.once("_promiseEmoteonly",r=>{r?n(r):t([e])})})},emoteonlyoff(e){return e=v.channel(e),this._sendCommand(null,e,"/emoteonlyoff",(t,n)=>{this.once("_promiseEmoteonlyoff",r=>{r?n(r):t([e])})})},followersonly:st,followersmode:st,followersonlyoff:ot,followersmodeoff:ot,host(e,t){return e=v.channel(e),t=v.username(t),this._sendCommand(2e3,e,`/host ${t}`,(n,r)=>{this.once("_promiseHost",(s,o)=>{s?r(s):n([e,t,~~o])})})},join(e){return e=v.channel(e),this._sendCommand(void 0,null,`JOIN ${e}`,(t,n)=>{const r="_promiseJoin";let s=!1;const o=(a,m)=>{e===v.channel(m)&&(this.removeListener(r,o),s=!0,a?n(a):t([e]))};this.on(r,o);const c=this._getPromiseDelay();v.promiseDelay(c).then(()=>{s||this.emit(r,"No response from Twitch.",e)})})},mod(e,t){return e=v.channel(e),t=v.username(t),this._sendCommand(null,e,`/mod ${t}`,(n,r)=>{this.once("_promiseMod",s=>{s?r(s):n([e,t])})})},mods(e){return e=v.channel(e),this._sendCommand(null,e,"/mods",(t,n)=>{this.once("_promiseMods",(r,s)=>{r?n(r):(s.forEach(o=>{this.moderators[e]||(this.moderators[e]=[]),this.moderators[e].includes(o)||this.moderators[e].push(o)}),t(s))})})},part:it,leave:it,ping(){return this._sendCommand(null,null,"PING",(e,t)=>{this.latency=new Date,this.pingTimeout=setTimeout(()=>{this.ws!==null&&(this.wasCloseCalled=!1,this.log.error("Ping timeout."),this.ws.close(),clearInterval(this.pingLoop),clearTimeout(this.pingTimeout))},v.get(this.opts.connection.timeout,9999)),this.once("_promisePing",n=>e([parseFloat(n)]))})},r9kbeta:at,r9kmode:at,r9kbetaoff:ut,r9kmodeoff:ut,raw(e){return this._sendCommand(null,null,e,(t,n)=>{t([e])})},say(e,t){return e=v.channel(e),t.startsWith(".")&&!t.startsWith("..")||t.startsWith("/")||t.startsWith("\\")?t.substr(1,3)==="me "?this.action(e,t.substr(4)):this._sendCommand(null,e,t,(n,r)=>{n([e,t])}):this._sendMessage(this._getPromiseDelay(),e,t,(n,r)=>{n([e,t])})},slow:ct,slowmode:ct,slowoff:lt,slowmodeoff:lt,subscribers(e){return e=v.channel(e),this._sendCommand(null,e,"/subscribers",(t,n)=>{this.once("_promiseSubscribers",r=>{r?n(r):t([e])})})},subscribersoff(e){return e=v.channel(e),this._sendCommand(null,e,"/subscribersoff",(t,n)=>{this.once("_promiseSubscribersoff",r=>{r?n(r):t([e])})})},timeout(e,t,n,r){return e=v.channel(e),t=v.username(t),n!==null&&!v.isInteger(n)&&(r=n,n=300),n=v.get(n,300),r=v.get(r,""),this._sendCommand(null,e,`/timeout ${t} ${n} ${r}`,(s,o)=>{this.once("_promiseTimeout",c=>{c?o(c):s([e,t,~~n,r])})})},unban(e,t){return e=v.channel(e),t=v.username(t),this._sendCommand(null,e,`/unban ${t}`,(n,r)=>{this.once("_promiseUnban",s=>{s?r(s):n([e,t])})})},unhost(e){return e=v.channel(e),this._sendCommand(2e3,e,"/unhost",(t,n)=>{this.once("_promiseUnhost",r=>{r?n(r):t([e])})})},unmod(e,t){return e=v.channel(e),t=v.username(t),this._sendCommand(null,e,`/unmod ${t}`,(n,r)=>{this.once("_promiseUnmod",s=>{s?r(s):n([e,t])})})},unvip(e,t){return e=v.channel(e),t=v.username(t),this._sendCommand(null,e,`/unvip ${t}`,(n,r)=>{this.once("_promiseUnvip",s=>{s?r(s):n([e,t])})})},vip(e,t){return e=v.channel(e),t=v.username(t),this._sendCommand(null,e,`/vip ${t}`,(n,r)=>{this.once("_promiseVip",s=>{s?r(s):n([e,t])})})},vips(e){return e=v.channel(e),this._sendCommand(null,e,"/vips",(t,n)=>{this.once("_promiseVips",(r,s)=>{r?n(r):t(s)})})},whisper(e,t){return e=v.username(e),e===this.getUsername()?Promise.reject("Cannot send a whisper to the same account."):this._sendCommand(null,"#tmijs",`/w ${e} ${t}`,(n,r)=>{this.once("_promiseWhisper",s=>{s&&r(s)})}).catch(n=>{if(n&&typeof n=="string"&&n.indexOf("No response from Twitch.")!==0)throw n;const r=v.channel(e),s=Object.assign({"message-type":"whisper","message-id":null,"thread-id":null,username:this.getUsername()},this.globaluserstate);return this.emits(["whisper","message"],[[r,s,t,!0],[r,s,t,!0]]),[e,t]})}};function A(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var Bn=A;A.EventEmitter=A;A.prototype._events=void 0;A.prototype._maxListeners=void 0;A.defaultMaxListeners=10;A.prototype.setMaxListeners=function(e){if(!Kn(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this};A.prototype.emit=function(e){var t,n,r,s,o,c;if(this._events||(this._events={}),e==="error"&&(!this._events.error||ae(this._events.error)&&!this._events.error.length))throw t=arguments[1],t instanceof Error?t:TypeError('Uncaught, unspecified "error" event.');if(n=this._events[e],rn(n))return!1;if(D(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(ae(n))for(s=Array.prototype.slice.call(arguments,1),c=n.slice(),r=c.length,o=0;o<r;o++)c[o].apply(this,s);return!0};A.prototype.addListener=function(e,t){var n;if(!D(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,D(t.listener)?t.listener:t),this._events[e]?ae(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,ae(this._events[e])&&!this._events[e].warned&&(rn(this._maxListeners)?n=A.defaultMaxListeners:n=this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),typeof console.trace=="function"&&console.trace())),this};A.prototype.on=A.prototype.addListener;A.prototype.once=function(e,t){if(!D(t))throw TypeError("listener must be a function");var n=!1;if(this._events.hasOwnProperty(e)&&e.charAt(0)==="_"){var r=1,s=e;for(var o in this._events)this._events.hasOwnProperty(o)&&o.startsWith(s)&&r++;e=e+r}function c(){e.charAt(0)==="_"&&!isNaN(e.substr(e.length-1))&&(e=e.substring(0,e.length-1)),this.removeListener(e,c),n||(n=!0,t.apply(this,arguments))}return c.listener=t,this.on(e,c),this};A.prototype.removeListener=function(e,t){var n,r,s,o;if(!D(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,r=-1,n===t||D(n.listener)&&n.listener===t){if(delete this._events[e],this._events.hasOwnProperty(e+"2")&&e.charAt(0)==="_"){var c=e;for(var a in this._events)this._events.hasOwnProperty(a)&&a.startsWith(c)&&(isNaN(parseInt(a.substr(a.length-1)))||(this._events[e+parseInt(a.substr(a.length-1)-1)]=this._events[a],delete this._events[a]));this._events[e]=this._events[e+"1"],delete this._events[e+"1"]}this._events.removeListener&&this.emit("removeListener",e,t)}else if(ae(n)){for(o=s;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){r=o;break}if(r<0)return this;n.length===1?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this};A.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[e]&&delete this._events[e],this;if(arguments.length===0){for(t in this._events)t!=="removeListener"&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],D(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this};A.prototype.listeners=function(e){var t;return!this._events||!this._events[e]?t=[]:D(this._events[e])?t=[this._events[e]]:t=this._events[e].slice(),t};A.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(D(t))return 1;if(t)return t.length}return 0};A.listenerCount=function(e,t){return e.listenerCount(t)};function D(e){return typeof e=="function"}function Kn(e){return typeof e=="number"}function ae(e){return typeof e=="object"&&e!==null}function rn(e){return e===void 0}const Yn=fe;let sn="info";const ft={trace:0,debug:1,info:2,warn:3,error:4,fatal:5};function V(e){return function(t){ft[e]>=ft[sn]&&console.log(`[${Yn.formatDate(new Date)}] ${e}: ${t}`)}}var Qn={setLevel(e){sn=e},trace:V("trace"),debug:V("debug"),info:V("info"),warn:V("warn"),error:V("error"),fatal:V("fatal")};const Oe=fe,G=/\S+/g;function Se(e,t,n=",",r="/",s){const o=e[t];if(o===void 0)return e;const c=typeof o=="string";if(e[t+"-raw"]=c?o:null,o===!0)return e[t]=null,e;if(e[t]={},c){const a=o.split(n);for(let m=0;m<a.length;m++){const h=a[m].split(r);let f=h[1];s!==void 0&&f&&(f=f.split(s)),e[t][h[0]]=f||null}}return e}var Xn={badges:e=>Se(e,"badges"),badgeInfo:e=>Se(e,"badge-info"),emotes:e=>Se(e,"emotes","/",":",","),emoteRegex(e,t,n,r){G.lastIndex=0;const s=new RegExp("(\\b|^|\\s)"+Oe.unescapeHtml(t)+"(\\b|$|\\s)");let o;for(;(o=G.exec(e))!==null;)s.test(o[0])&&(r[n]=r[n]||[],r[n].push([o.index,G.lastIndex-1]))},emoteString(e,t,n,r){G.lastIndex=0;let s;for(;(s=G.exec(e))!==null;)s[0]===Oe.unescapeHtml(t)&&(r[n]=r[n]||[],r[n].push([s.index,G.lastIndex-1]))},transformEmotes(e){let t="";return Object.keys(e).forEach(n=>{t=`${t+n}:`,e[n].forEach(r=>t=`${t+r.join("-")},`),t=`${t.slice(0,-1)}/`}),t.slice(0,-1)},formTags(e){const t=[];for(const n in e){const r=Oe.escapeIRC(e[n]);t.push(`${n}=${r}`)}return`@${t.join(";")}`},msg(e){const t={raw:e,tags:{},prefix:null,command:null,params:[]};let n=0,r=0;if(e.charCodeAt(0)===64){if(r=e.indexOf(" "),r===-1)return null;const s=e.slice(1,r).split(";");for(let o=0;o<s.length;o++){const c=s[o],a=c.split("=");t.tags[a[0]]=c.substring(c.indexOf("=")+1)||!0}n=r+1}for(;e.charCodeAt(n)===32;)n++;if(e.charCodeAt(n)===58){if(r=e.indexOf(" ",n),r===-1)return null;for(t.prefix=e.slice(n+1,r),n=r+1;e.charCodeAt(n)===32;)n++}if(r=e.indexOf(" ",n),r===-1)return e.length>n?(t.command=e.slice(n),t):null;for(t.command=e.slice(n,r),n=r+1;e.charCodeAt(n)===32;)n++;for(;n<e.length;){if(r=e.indexOf(" ",n),e.charCodeAt(n)===58){t.params.push(e.slice(n+1));break}if(r!==-1){for(t.params.push(e.slice(n,r)),n=r+1;e.charCodeAt(n)===32;)n++;continue}if(r===-1){t.params.push(e.slice(n));break}}return t}};class Zn{constructor(t){this.queue=[],this.index=0,this.defaultDelay=t===void 0?3e3:t}add(t,n){this.queue.push({fn:t,delay:n})}next(){const t=this.index++,n=this.queue[t];if(!n)return;const r=this.queue[this.index];if(n.fn(),r){const s=r.delay===void 0?this.defaultDelay:r.delay;setTimeout(()=>this.next(),s)}}}var er=Zn;(function(e){const t=typeof et<"u"?et:typeof window<"u"?window:{},n=t.WebSocket||Pe,r=t.fetch||Pe,s=Gn,o=Wn,c=Bn.EventEmitter,a=Qn,m=Xn,h=er,f=fe;let w=!1;const b=function y(l){if(!(this instanceof y))return new y(l);this.opts=f.get(l,{}),this.opts.channels=this.opts.channels||[],this.opts.connection=this.opts.connection||{},this.opts.identity=this.opts.identity||{},this.opts.options=this.opts.options||{},this.clientId=f.get(this.opts.options.clientId,null),this._globalDefaultChannel=f.channel(f.get(this.opts.options.globalDefaultChannel,"#tmijs")),this._skipMembership=f.get(this.opts.options.skipMembership,!1),this._skipUpdatingEmotesets=f.get(this.opts.options.skipUpdatingEmotesets,!1),this._updateEmotesetsTimer=null,this._updateEmotesetsTimerDelay=f.get(this.opts.options.updateEmotesetsTimer,6e4),this.maxReconnectAttempts=f.get(this.opts.connection.maxReconnectAttempts,1/0),this.maxReconnectInterval=f.get(this.opts.connection.maxReconnectInterval,3e4),this.reconnect=f.get(this.opts.connection.reconnect,!0),this.reconnectDecay=f.get(this.opts.connection.reconnectDecay,1.5),this.reconnectInterval=f.get(this.opts.connection.reconnectInterval,1e3),this.reconnecting=!1,this.reconnections=0,this.reconnectTimer=this.reconnectInterval,this.secure=f.get(this.opts.connection.secure,!this.opts.connection.server&&!this.opts.connection.port),this.emotes="",this.emotesets={},this.channels=[],this.currentLatency=0,this.globaluserstate={},this.lastJoined="",this.latency=new Date,this.moderators={},this.pingLoop=null,this.pingTimeout=null,this.reason="",this.username="",this.userstate={},this.wasCloseCalled=!1,this.ws=null;let u="error";this.opts.options.debug&&(u="info"),this.log=this.opts.logger||a;try{a.setLevel(u)}catch{}this.opts.channels.forEach((p,O,_)=>_[O]=f.channel(p)),c.call(this),this.setMaxListeners(0)};f.inherits(b,c);for(const y in o)b.prototype[y]=o[y];b.prototype.emits=function(l,u){for(let p=0;p<l.length;p++){const O=p<u.length?u[p]:u[u.length-1];this.emit.apply(this,[l[p]].concat(O))}},b.prototype.api=function(...y){w||(this.log.warn("Client.prototype.api is deprecated and will be removed for version 2.0.0"),w=!0),s(...y)},b.prototype.handleMessage=function(l){if(!l)return;this.listenerCount("raw_message")&&this.emit("raw_message",JSON.parse(JSON.stringify(l)),l);const u=f.channel(f.get(l.params[0],null));let p=f.get(l.params[1],null);const O=f.get(l.tags["msg-id"],null),_=l.tags=m.badges(m.badgeInfo(m.emotes(l.tags)));for(const d in _){if(d==="emote-sets"||d==="ban-duration"||d==="bits")continue;let g=_[d];typeof g=="boolean"?g=null:g==="1"?g=!0:g==="0"?g=!1:typeof g=="string"&&(g=f.unescapeIRC(g)),_[d]=g}if(l.prefix===null)switch(l.command){case"PING":this.emit("ping"),this._isConnected()&&this.ws.send("PONG");break;case"PONG":{const d=new Date;this.currentLatency=(d.getTime()-this.latency.getTime())/1e3,this.emits(["pong","_promisePing"],[[this.currentLatency]]),clearTimeout(this.pingTimeout);break}default:this.log.warn(`Could not parse message with no prefix:
${JSON.stringify(l,null,4)}`);break}else if(l.prefix==="tmi.twitch.tv")switch(l.command){case"002":case"003":case"004":case"372":case"375":case"CAP":break;case"001":this.username=l.params[0];break;case"376":{this.log.info("Connected to server."),this.userstate[this._globalDefaultChannel]={},this.emits(["connected","_promiseConnect"],[[this.server,this.port],[null]]),this.reconnections=0,this.reconnectTimer=this.reconnectInterval,this.pingLoop=setInterval(()=>{this._isConnected()&&this.ws.send("PING"),this.latency=new Date,this.pingTimeout=setTimeout(()=>{this.ws!==null&&(this.wasCloseCalled=!1,this.log.error("Ping timeout."),this.ws.close(),clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),clearTimeout(this._updateEmotesetsTimer))},f.get(this.opts.connection.timeout,9999))},6e4);let d=f.get(this.opts.options.joinInterval,2e3);d<300&&(d=300);const g=new h(d),$=[...new Set([...this.opts.channels,...this.channels])];this.channels=[];for(let E=0;E<$.length;E++){const T=$[E];g.add(()=>{this._isConnected()&&this.join(T).catch(C=>this.log.error(C))})}g.next();break}case"NOTICE":{const d=[null],g=[u,O,p],$=[O],E=[u,!0],T=[u,!1],C=[g,d],k=[g,$],S=`[${u}] ${p}`;switch(O){case"subs_on":this.log.info(`[${u}] This room is now in subscribers-only mode.`),this.emits(["subscriber","subscribers","_promiseSubscribers"],[E,E,d]);break;case"subs_off":this.log.info(`[${u}] This room is no longer in subscribers-only mode.`),this.emits(["subscriber","subscribers","_promiseSubscribersoff"],[T,T,d]);break;case"emote_only_on":this.log.info(`[${u}] This room is now in emote-only mode.`),this.emits(["emoteonly","_promiseEmoteonly"],[E,d]);break;case"emote_only_off":this.log.info(`[${u}] This room is no longer in emote-only mode.`),this.emits(["emoteonly","_promiseEmoteonlyoff"],[T,d]);break;case"slow_on":case"slow_off":break;case"followers_on_zero":case"followers_on":case"followers_off":break;case"r9k_on":this.log.info(`[${u}] This room is now in r9k mode.`),this.emits(["r9kmode","r9kbeta","_promiseR9kbeta"],[E,E,d]);break;case"r9k_off":this.log.info(`[${u}] This room is no longer in r9k mode.`),this.emits(["r9kmode","r9kbeta","_promiseR9kbetaoff"],[T,T,d]);break;case"room_mods":{const j=p.split(": "),U=(j.length>1?j[1]:"").toLowerCase().split(", ").filter(ve=>ve);this.emits(["_promiseMods","mods"],[[null,U],[u,U]]);break}case"no_mods":this.emits(["_promiseMods","mods"],[[null,[]],[u,[]]]);break;case"vips_success":{p.endsWith(".")&&(p=p.slice(0,-1));const j=p.split(": "),U=(j.length>1?j[1]:"").toLowerCase().split(", ").filter(ve=>ve);this.emits(["_promiseVips","vips"],[[null,U],[u,U]]);break}case"no_vips":this.emits(["_promiseVips","vips"],[[null,[]],[u,[]]]);break;case"already_banned":case"bad_ban_admin":case"bad_ban_anon":case"bad_ban_broadcaster":case"bad_ban_global_mod":case"bad_ban_mod":case"bad_ban_self":case"bad_ban_staff":case"usage_ban":this.log.info(S),this.emits(["notice","_promiseBan"],k);break;case"ban_success":this.log.info(S),this.emits(["notice","_promiseBan"],C);break;case"usage_clear":this.log.info(S),this.emits(["notice","_promiseClear"],k);break;case"usage_mods":this.log.info(S),this.emits(["notice","_promiseMods"],[g,[O,[]]]);break;case"mod_success":this.log.info(S),this.emits(["notice","_promiseMod"],C);break;case"usage_vips":this.log.info(S),this.emits(["notice","_promiseVips"],[g,[O,[]]]);break;case"usage_vip":case"bad_vip_grantee_banned":case"bad_vip_grantee_already_vip":case"bad_vip_max_vips_reached":case"bad_vip_achievement_incomplete":this.log.info(S),this.emits(["notice","_promiseVip"],[g,[O,[]]]);break;case"vip_success":this.log.info(S),this.emits(["notice","_promiseVip"],C);break;case"usage_mod":case"bad_mod_banned":case"bad_mod_mod":this.log.info(S),this.emits(["notice","_promiseMod"],k);break;case"unmod_success":this.log.info(S),this.emits(["notice","_promiseUnmod"],C);break;case"unvip_success":this.log.info(S),this.emits(["notice","_promiseUnvip"],C);break;case"usage_unmod":case"bad_unmod_mod":this.log.info(S),this.emits(["notice","_promiseUnmod"],k);break;case"usage_unvip":case"bad_unvip_grantee_not_vip":this.log.info(S),this.emits(["notice","_promiseUnvip"],k);break;case"color_changed":this.log.info(S),this.emits(["notice","_promiseColor"],C);break;case"usage_color":case"turbo_only_color":this.log.info(S),this.emits(["notice","_promiseColor"],k);break;case"commercial_success":this.log.info(S),this.emits(["notice","_promiseCommercial"],C);break;case"usage_commercial":case"bad_commercial_error":this.log.info(S),this.emits(["notice","_promiseCommercial"],k);break;case"hosts_remaining":{this.log.info(S);const j=isNaN(p[0])?0:parseInt(p[0]);this.emits(["notice","_promiseHost"],[g,[null,~~j]]);break}case"bad_host_hosting":case"bad_host_rate_exceeded":case"bad_host_error":case"usage_host":this.log.info(S),this.emits(["notice","_promiseHost"],[g,[O,null]]);break;case"already_r9k_on":case"usage_r9k_on":this.log.info(S),this.emits(["notice","_promiseR9kbeta"],k);break;case"already_r9k_off":case"usage_r9k_off":this.log.info(S),this.emits(["notice","_promiseR9kbetaoff"],k);break;case"timeout_success":this.log.info(S),this.emits(["notice","_promiseTimeout"],C);break;case"delete_message_success":this.log.info(`[${u} ${p}]`),this.emits(["notice","_promiseDeletemessage"],C);break;case"already_subs_off":case"usage_subs_off":this.log.info(S),this.emits(["notice","_promiseSubscribersoff"],k);break;case"already_subs_on":case"usage_subs_on":this.log.info(S),this.emits(["notice","_promiseSubscribers"],k);break;case"already_emote_only_off":case"usage_emote_only_off":this.log.info(S),this.emits(["notice","_promiseEmoteonlyoff"],k);break;case"already_emote_only_on":case"usage_emote_only_on":this.log.info(S),this.emits(["notice","_promiseEmoteonly"],k);break;case"usage_slow_on":this.log.info(S),this.emits(["notice","_promiseSlow"],k);break;case"usage_slow_off":this.log.info(S),this.emits(["notice","_promiseSlowoff"],k);break;case"usage_timeout":case"bad_timeout_admin":case"bad_timeout_anon":case"bad_timeout_broadcaster":case"bad_timeout_duration":case"bad_timeout_global_mod":case"bad_timeout_mod":case"bad_timeout_self":case"bad_timeout_staff":this.log.info(S),this.emits(["notice","_promiseTimeout"],k);break;case"untimeout_success":case"unban_success":this.log.info(S),this.emits(["notice","_promiseUnban"],C);break;case"usage_unban":case"bad_unban_no_ban":this.log.info(S),this.emits(["notice","_promiseUnban"],k);break;case"usage_delete":case"bad_delete_message_error":case"bad_delete_message_broadcaster":case"bad_delete_message_mod":this.log.info(S),this.emits(["notice","_promiseDeletemessage"],k);break;case"usage_unhost":case"not_hosting":this.log.info(S),this.emits(["notice","_promiseUnhost"],k);break;case"whisper_invalid_login":case"whisper_invalid_self":case"whisper_limit_per_min":case"whisper_limit_per_sec":case"whisper_restricted":case"whisper_restricted_recipient":this.log.info(S),this.emits(["notice","_promiseWhisper"],k);break;case"no_permission":case"msg_banned":case"msg_room_not_found":case"msg_channel_suspended":case"tos_ban":case"invalid_user":this.log.info(S),this.emits(["notice","_promiseBan","_promiseClear","_promiseUnban","_promiseTimeout","_promiseDeletemessage","_promiseMods","_promiseMod","_promiseUnmod","_promiseVips","_promiseVip","_promiseUnvip","_promiseCommercial","_promiseHost","_promiseUnhost","_promiseJoin","_promisePart","_promiseR9kbeta","_promiseR9kbetaoff","_promiseSlow","_promiseSlowoff","_promiseFollowers","_promiseFollowersoff","_promiseSubscribers","_promiseSubscribersoff","_promiseEmoteonly","_promiseEmoteonlyoff","_promiseWhisper"],[g,[O,u]]);break;case"msg_rejected":case"msg_rejected_mandatory":this.log.info(S),this.emit("automod",u,O,p);break;case"unrecognized_cmd":this.log.info(S),this.emit("notice",u,O,p);break;case"cmds_available":case"host_target_went_offline":case"msg_censored_broadcaster":case"msg_duplicate":case"msg_emoteonly":case"msg_verified_email":case"msg_ratelimit":case"msg_subsonly":case"msg_timedout":case"msg_bad_characters":case"msg_channel_blocked":case"msg_facebook":case"msg_followersonly":case"msg_followersonly_followed":case"msg_followersonly_zero":case"msg_slowmode":case"msg_suspended":case"no_help":case"usage_disconnect":case"usage_help":case"usage_me":case"unavailable_command":this.log.info(S),this.emit("notice",u,O,p);break;case"host_on":case"host_off":break;default:p.includes("Login unsuccessful")||p.includes("Login authentication failed")?(this.wasCloseCalled=!1,this.reconnect=!1,this.reason=p,this.log.error(this.reason),this.ws.close()):p.includes("Error logging in")||p.includes("Improperly formatted auth")?(this.wasCloseCalled=!1,this.reconnect=!1,this.reason=p,this.log.error(this.reason),this.ws.close()):p.includes("Invalid NICK")?(this.wasCloseCalled=!1,this.reconnect=!1,this.reason="Invalid NICK.",this.log.error(this.reason),this.ws.close()):(this.log.warn(`Could not parse NOTICE from tmi.twitch.tv:
${JSON.stringify(l,null,4)}`),this.emit("notice",u,O,p));break}break}case"USERNOTICE":{const d=_["display-name"]||_.login,g=_["msg-param-sub-plan"]||"",$=f.unescapeIRC(f.get(_["msg-param-sub-plan-name"],""))||null,T={prime:g.includes("Prime"),plan:g,planName:$},C=~~(_["msg-param-streak-months"]||0),k=_["msg-param-recipient-display-name"]||_["msg-param-recipient-user-name"],S=~~_["msg-param-mass-gift-count"];switch(_["message-type"]=O,O){case"resub":this.emits(["resub","subanniversary"],[[u,d,C,p,_,T]]);break;case"sub":this.emits(["subscription","sub"],[[u,d,T,p,_]]);break;case"subgift":this.emit("subgift",u,d,C,k,T,_);break;case"anonsubgift":this.emit("anonsubgift",u,C,k,T,_);break;case"submysterygift":this.emit("submysterygift",u,d,S,T,_);break;case"anonsubmysterygift":this.emit("anonsubmysterygift",u,S,T,_);break;case"primepaidupgrade":this.emit("primepaidupgrade",u,d,T,_);break;case"giftpaidupgrade":{const j=_["msg-param-sender-name"]||_["msg-param-sender-login"];this.emit("giftpaidupgrade",u,d,j,_);break}case"anongiftpaidupgrade":this.emit("anongiftpaidupgrade",u,d,_);break;case"raid":{const j=_["msg-param-displayName"]||_["msg-param-login"],U=+_["msg-param-viewerCount"];this.emit("raided",u,j,U,_);break}case"ritual":{const j=_["msg-param-ritual-name"];switch(j){case"new_chatter":this.emit("newchatter",u,d,_,p);break;default:this.emit("ritual",j,u,d,_,p);break}break}default:this.emit("usernotice",O,u,_,p);break}break}case"HOSTTARGET":{const d=p.split(" "),g=~~d[1]||0;d[0]==="-"?(this.log.info(`[${u}] Exited host mode.`),this.emits(["unhost","_promiseUnhost"],[[u,g],[null]])):(this.log.info(`[${u}] Now hosting ${d[0]} for ${g} viewer(s).`),this.emit("hosting",u,d[0],g));break}case"CLEARCHAT":if(l.params.length>1){const d=f.get(l.tags["ban-duration"],null);d===null?(this.log.info(`[${u}] ${p} has been banned.`),this.emit("ban",u,p,null,l.tags)):(this.log.info(`[${u}] ${p} has been timed out for ${d} seconds.`),this.emit("timeout",u,p,null,~~d,l.tags))}else this.log.info(`[${u}] Chat was cleared by a moderator.`),this.emits(["clearchat","_promiseClear"],[[u],[null]]);break;case"CLEARMSG":if(l.params.length>1){const d=p,g=_.login;_["message-type"]="messagedeleted",this.log.info(`[${u}] ${g}'s message has been deleted.`),this.emit("messagedeleted",u,g,d,_)}break;case"RECONNECT":this.log.info("Received RECONNECT request from Twitch.."),this.log.info(`Disconnecting and reconnecting in ${Math.round(this.reconnectTimer/1e3)} seconds..`),this.disconnect().catch(d=>this.log.error(d)),setTimeout(()=>this.connect().catch(d=>this.log.error(d)),this.reconnectTimer);break;case"USERSTATE":l.tags.username=this.username,l.tags["user-type"]==="mod"&&(this.moderators[u]||(this.moderators[u]=[]),this.moderators[u].includes(this.username)||this.moderators[u].push(this.username)),!f.isJustinfan(this.getUsername())&&!this.userstate[u]&&(this.userstate[u]=_,this.lastJoined=u,this.channels.push(u),this.log.info(`Joined ${u}`),this.emit("join",u,f.username(this.getUsername()),!0)),l.tags["emote-sets"]!==this.emotes&&this._updateEmoteset(l.tags["emote-sets"]),this.userstate[u]=_;break;case"GLOBALUSERSTATE":this.globaluserstate=_,this.emit("globaluserstate",_),typeof l.tags["emote-sets"]<"u"&&this._updateEmoteset(l.tags["emote-sets"]);break;case"ROOMSTATE":if(f.channel(this.lastJoined)===u&&this.emit("_promiseJoin",null,u),l.tags.channel=u,this.emit("roomstate",u,l.tags),!f.hasOwn(l.tags,"subs-only")){if(f.hasOwn(l.tags,"slow"))if(typeof l.tags.slow=="boolean"&&!l.tags.slow){const d=[u,!1,0];this.log.info(`[${u}] This room is no longer in slow mode.`),this.emits(["slow","slowmode","_promiseSlowoff"],[d,d,[null]])}else{const d=~~l.tags.slow,g=[u,!0,d];this.log.info(`[${u}] This room is now in slow mode.`),this.emits(["slow","slowmode","_promiseSlow"],[g,g,[null]])}if(f.hasOwn(l.tags,"followers-only"))if(l.tags["followers-only"]==="-1"){const d=[u,!1,0];this.log.info(`[${u}] This room is no longer in followers-only mode.`),this.emits(["followersonly","followersmode","_promiseFollowersoff"],[d,d,[null]])}else{const d=~~l.tags["followers-only"],g=[u,!0,d];this.log.info(`[${u}] This room is now in follower-only mode.`),this.emits(["followersonly","followersmode","_promiseFollowers"],[g,g,[null]])}}break;case"SERVERCHANGE":break;default:this.log.warn(`Could not parse message from tmi.twitch.tv:
${JSON.stringify(l,null,4)}`);break}else if(l.prefix==="jtv")switch(l.command){case"MODE":p==="+o"?(this.moderators[u]||(this.moderators[u]=[]),this.moderators[u].includes(l.params[2])||this.moderators[u].push(l.params[2]),this.emit("mod",u,l.params[2])):p==="-o"&&(this.moderators[u]||(this.moderators[u]=[]),this.moderators[u].filter(d=>d!==l.params[2]),this.emit("unmod",u,l.params[2]));break;default:this.log.warn(`Could not parse message from jtv:
${JSON.stringify(l,null,4)}`);break}else switch(l.command){case"353":this.emit("names",l.params[2],l.params[3].split(" "));break;case"366":break;case"JOIN":{const d=l.prefix.split("!")[0];f.isJustinfan(this.getUsername())&&this.username===d&&(this.lastJoined=u,this.channels.push(u),this.log.info(`Joined ${u}`),this.emit("join",u,d,!0)),this.username!==d&&this.emit("join",u,d,!1);break}case"PART":{let d=!1;const g=l.prefix.split("!")[0];if(this.username===g){d=!0,this.userstate[u]&&delete this.userstate[u];let $=this.channels.indexOf(u);$!==-1&&this.channels.splice($,1),$=this.opts.channels.indexOf(u),$!==-1&&this.opts.channels.splice($,1),this.log.info(`Left ${u}`),this.emit("_promisePart",null)}this.emit("part",u,g,d);break}case"WHISPER":{const d=l.prefix.split("!")[0];this.log.info(`[WHISPER] <${d}>: ${p}`),f.hasOwn(l.tags,"username")||(l.tags.username=d),l.tags["message-type"]="whisper";const g=f.channel(l.tags.username);this.emits(["whisper","message"],[[g,l.tags,p,!1]]);break}case"PRIVMSG":if(l.tags.username=l.prefix.split("!")[0],l.tags.username==="jtv"){const d=f.username(p.split(" ")[0]),g=p.includes("auto");if(p.includes("hosting you for")){const $=f.extractNumber(p);this.emit("hosted",u,d,$,g)}else p.includes("hosting you")&&this.emit("hosted",u,d,0,g)}else{const d=f.get(this.opts.options.messagesLogLevel,"info"),g=f.actionMessage(p);if(l.tags["message-type"]=g?"action":"chat",p=g?g[1]:p,f.hasOwn(l.tags,"bits"))this.emit("cheer",u,l.tags,p);else{if(f.hasOwn(l.tags,"msg-id")){if(l.tags["msg-id"]==="highlighted-message"){const $=l.tags["msg-id"];this.emit("redeem",u,l.tags.username,$,l.tags,p)}else if(l.tags["msg-id"]==="skip-subs-mode-message"){const $=l.tags["msg-id"];this.emit("redeem",u,l.tags.username,$,l.tags,p)}}else if(f.hasOwn(l.tags,"custom-reward-id")){const $=l.tags["custom-reward-id"];this.emit("redeem",u,l.tags.username,$,l.tags,p)}g?(this.log[d](`[${u}] *<${l.tags.username}>: ${p}`),this.emits(["action","message"],[[u,l.tags,p,!1]])):(this.log[d](`[${u}] <${l.tags.username}>: ${p}`),this.emits(["chat","message"],[[u,l.tags,p,!1]]))}}break;default:this.log.warn(`Could not parse message:
${JSON.stringify(l,null,4)}`);break}},b.prototype.connect=function(){return new Promise((l,u)=>{this.server=f.get(this.opts.connection.server,"irc-ws.chat.twitch.tv"),this.port=f.get(this.opts.connection.port,80),this.secure&&(this.port=443),this.port===443&&(this.secure=!0),this.reconnectTimer=this.reconnectTimer*this.reconnectDecay,this.reconnectTimer>=this.maxReconnectInterval&&(this.reconnectTimer=this.maxReconnectInterval),this._openConnection(),this.once("_promiseConnect",p=>{p?u(p):l([this.server,~~this.port])})})},b.prototype._openConnection=function(){const l=`${this.secure?"wss":"ws"}://${this.server}:${this.port}/`,u={};"agent"in this.opts.connection&&(u.agent=this.opts.connection.agent),this.ws=new n(l,"irc",u),this.ws.onmessage=this._onMessage.bind(this),this.ws.onerror=this._onError.bind(this),this.ws.onclose=this._onClose.bind(this),this.ws.onopen=this._onOpen.bind(this)},b.prototype._onOpen=function(){this._isConnected()&&(this.log.info(`Connecting to ${this.server} on port ${this.port}..`),this.emit("connecting",this.server,~~this.port),this.username=f.get(this.opts.identity.username,f.justinfan()),this._getToken().then(l=>{const u=f.password(l);this.log.info("Sending authentication to server.."),this.emit("logon");let p="twitch.tv/tags twitch.tv/commands";this._skipMembership||(p+=" twitch.tv/membership"),this.ws.send("CAP REQ :"+p),u?this.ws.send(`PASS ${u}`):f.isJustinfan(this.username)&&this.ws.send("PASS SCHMOOPIIE"),this.ws.send(`NICK ${this.username}`)}).catch(l=>{this.emits(["_promiseConnect","disconnected"],[[l],["Could not get a token."]])}))},b.prototype._getToken=function(){const l=this.opts.identity.password;let u;return typeof l=="function"?(u=l(),u instanceof Promise?u:Promise.resolve(u)):Promise.resolve(l)},b.prototype._onMessage=function(l){l.data.trim().split(`\r
`).forEach(p=>{const O=m.msg(p);O&&this.handleMessage(O)})},b.prototype._onError=function(){this.moderators={},this.userstate={},this.globaluserstate={},clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),clearTimeout(this._updateEmotesetsTimer),this.reason=this.ws===null?"Connection closed.":"Unable to connect.",this.emits(["_promiseConnect","disconnected"],[[this.reason]]),this.reconnect&&this.reconnections===this.maxReconnectAttempts&&(this.emit("maxreconnect"),this.log.error("Maximum reconnection attempts reached.")),this.reconnect&&!this.reconnecting&&this.reconnections<=this.maxReconnectAttempts-1&&(this.reconnecting=!0,this.reconnections=this.reconnections+1,this.log.error(`Reconnecting in ${Math.round(this.reconnectTimer/1e3)} seconds..`),this.emit("reconnect"),setTimeout(()=>{this.reconnecting=!1,this.connect().catch(l=>this.log.error(l))},this.reconnectTimer)),this.ws=null},b.prototype._onClose=function(){this.moderators={},this.userstate={},this.globaluserstate={},clearInterval(this.pingLoop),clearTimeout(this.pingTimeout),clearTimeout(this._updateEmotesetsTimer),this.wasCloseCalled?(this.wasCloseCalled=!1,this.reason="Connection closed.",this.log.info(this.reason),this.emits(["_promiseConnect","_promiseDisconnect","disconnected"],[[this.reason],[null],[this.reason]])):(this.emits(["_promiseConnect","disconnected"],[[this.reason]]),this.reconnect&&this.reconnections===this.maxReconnectAttempts&&(this.emit("maxreconnect"),this.log.error("Maximum reconnection attempts reached.")),this.reconnect&&!this.reconnecting&&this.reconnections<=this.maxReconnectAttempts-1&&(this.reconnecting=!0,this.reconnections=this.reconnections+1,this.log.error(`Could not connect to server. Reconnecting in ${Math.round(this.reconnectTimer/1e3)} seconds..`),this.emit("reconnect"),setTimeout(()=>{this.reconnecting=!1,this.connect().catch(l=>this.log.error(l))},this.reconnectTimer))),this.ws=null},b.prototype._getPromiseDelay=function(){return this.currentLatency<=600?600:this.currentLatency+100},b.prototype._sendCommand=function(l,u,p,O){return new Promise((_,d)=>{if(this._isConnected())(l===null||typeof l=="number")&&(l===null&&(l=this._getPromiseDelay()),f.promiseDelay(l).then(()=>d("No response from Twitch.")));else return d("Not connected to server.");if(u!==null){const g=f.channel(u);this.log.info(`[${g}] Executing command: ${p}`),this.ws.send(`PRIVMSG ${g} :${p}`)}else this.log.info(`Executing command: ${p}`),this.ws.send(p);typeof O=="function"?O(_,d):_()})},b.prototype._sendMessage=function(l,u,p,O){return new Promise((_,d)=>{if(this._isConnected()){if(f.isJustinfan(this.getUsername()))return d("Cannot send anonymous messages.")}else return d("Not connected to server.");const g=f.channel(u);if(this.userstate[g]||(this.userstate[g]={}),p.length>=500){const k=f.splitLine(p,500);p=k[0],setTimeout(()=>{this._sendMessage(l,u,k[1],()=>{})},350)}this.ws.send(`PRIVMSG ${g} :${p}`);const $={};Object.keys(this.emotesets).forEach(k=>this.emotesets[k].forEach(S=>(f.isRegex(S.code)?m.emoteRegex:m.emoteString)(p,S.code,S.id,$)));const E=Object.assign(this.userstate[g],m.emotes({emotes:m.transformEmotes($)||null})),T=f.get(this.opts.options.messagesLogLevel,"info"),C=f.actionMessage(p);C?(E["message-type"]="action",this.log[T](`[${g}] *<${this.getUsername()}>: ${C[1]}`),this.emits(["action","message"],[[g,E,C[1],!0]])):(E["message-type"]="chat",this.log[T](`[${g}] <${this.getUsername()}>: ${p}`),this.emits(["chat","message"],[[g,E,p,!0]])),typeof O=="function"?O(_,d):_()})},b.prototype._updateEmoteset=function(l){let u=l!==void 0;if(u&&(l===this.emotes?u=!1:this.emotes=l),this._skipUpdatingEmotesets){u&&this.emit("emotesets",l,{});return}const p=()=>{this._updateEmotesetsTimerDelay>0&&(clearTimeout(this._updateEmotesetsTimer),this._updateEmotesetsTimer=setTimeout(()=>this._updateEmoteset(l),this._updateEmotesetsTimerDelay))};this._getToken().then(O=>{const _=`https://api.twitch.tv/kraken/chat/emoticon_images?emotesets=${l}`,d={};return"fetchAgent"in this.opts.connection&&(d.agent=this.opts.connection.fetchAgent),r(_,{...d,headers:{Accept:"application/vnd.twitchtv.v5+json",Authorization:`OAuth ${f.token(O)}`,"Client-ID":this.clientId}})}).then(O=>O.json()).then(O=>{this.emotesets=O.emoticon_sets||{},this.emit("emotesets",l,this.emotesets),p()}).catch(()=>p())},b.prototype.getUsername=function(){return this.username},b.prototype.getOptions=function(){return this.opts},b.prototype.getChannels=function(){return this.channels},b.prototype.isMod=function(l,u){const p=f.channel(l);return this.moderators[p]||(this.moderators[p]=[]),this.moderators[p].includes(f.username(u))},b.prototype.readyState=function(){return this.ws===null?"CLOSED":["CONNECTING","OPEN","CLOSING","CLOSED"][this.ws.readyState]},b.prototype._isConnected=function(){return this.ws!==null&&this.ws.readyState===1},b.prototype.disconnect=function(){return new Promise((l,u)=>{this.ws!==null&&this.ws.readyState!==3?(this.wasCloseCalled=!0,this.log.info("Disconnecting from server.."),this.ws.close(),this.once("_promiseDisconnect",()=>l([this.server,~~this.port]))):(this.log.error("Cannot disconnect from server. Socket is not opened or connection is already closing."),u("Cannot disconnect from server. Socket is not opened or connection is already closing."))})},b.prototype.off=b.prototype.removeListener,e.exports&&(e.exports=b),typeof window<"u"&&(window.tmi={client:b,Client:b})})(tn);var tr=tn.exports;const mt=tr;var nr={client:mt,Client:mt};const rr=Mn(nr),W=[];function sr(e,t=N){let n;const r=new Set;function s(a){if(ye(e,a)&&(e=a,n)){const m=!W.length;for(const h of r)h[1](),W.push(h,e);if(m){for(let h=0;h<W.length;h+=2)W[h][0](W[h+1]);W.length=0}}}function o(a){s(a(e))}function c(a,m=N){const h=[a,m];return r.add(h),r.size===1&&(n=t(s)||N),a(e),()=>{r.delete(h),r.size===0&&n&&(n(),n=null)}}return{set:s,update:o,subscribe:c}}function Ee(){return{messages:[]}}function or(e,t){return{...e,messages:[...e.messages,t]}}function ir(e){const[t,...n]=e.messages;return{...e,messages:n}}function ar(e,t){const n=e.messages.filter(r=>r.uuid!=t);return{...e,messages:n}}const B=sr(Ee());var on="en",We={},xe={};function an(){return on}function ur(e){on=e}function cr(e){return We[e]}function lr(e){if(!e)throw new Error("No locale data passed");We[e.locale]=e,xe[e.locale.toLowerCase()]=e.locale}function ht(e){if(We[e])return e;if(xe[e.toLowerCase()])return xe[e.toLowerCase()]}function un(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.localeMatcher||"lookup";switch(n){case"lookup":return pt(e);case"best fit":return pt(e);default:throw new RangeError('Invalid "localeMatcher" option: '.concat(n))}}function pt(e){var t=ht(e);if(t)return t;for(var n=e.split("-");e.length>1;){n.pop(),e=n.join("-");var r=ht(e);if(r)return r}}var i={af:function(t){return t==1?"one":"other"},am:function(t){return t>=0&&t<=1?"one":"other"},ar:function(t){var n=String(t).split("."),r=Number(n[0])==t,s=r&&n[0].slice(-2);return t==0?"zero":t==1?"one":t==2?"two":s>=3&&s<=10?"few":s>=11&&s<=99?"many":"other"},ast:function(t){var n=String(t).split("."),r=!n[1];return t==1&&r?"one":"other"},be:function(t){var n=String(t).split("."),r=Number(n[0])==t,s=r&&n[0].slice(-1),o=r&&n[0].slice(-2);return s==1&&o!=11?"one":s>=2&&s<=4&&(o<12||o>14)?"few":r&&s==0||s>=5&&s<=9||o>=11&&o<=14?"many":"other"},br:function(t){var n=String(t).split("."),r=Number(n[0])==t,s=r&&n[0].slice(-1),o=r&&n[0].slice(-2),c=r&&n[0].slice(-6);return s==1&&o!=11&&o!=71&&o!=91?"one":s==2&&o!=12&&o!=72&&o!=92?"two":(s==3||s==4||s==9)&&(o<10||o>19)&&(o<70||o>79)&&(o<90||o>99)?"few":t!=0&&r&&c==0?"many":"other"},bs:function(t){var n=String(t).split("."),r=n[0],s=n[1]||"",o=!n[1],c=r.slice(-1),a=r.slice(-2),m=s.slice(-1),h=s.slice(-2);return o&&c==1&&a!=11||m==1&&h!=11?"one":o&&c>=2&&c<=4&&(a<12||a>14)||m>=2&&m<=4&&(h<12||h>14)?"few":"other"},ca:function(t){var n=String(t).split("."),r=n[0],s=!n[1],o=r.slice(-6);return t==1&&s?"one":r!=0&&o==0&&s?"many":"other"},ceb:function(t){var n=String(t).split("."),r=n[0],s=n[1]||"",o=!n[1],c=r.slice(-1),a=s.slice(-1);return o&&(r==1||r==2||r==3)||o&&c!=4&&c!=6&&c!=9||!o&&a!=4&&a!=6&&a!=9?"one":"other"},cs:function(t){var n=String(t).split("."),r=n[0],s=!n[1];return t==1&&s?"one":r>=2&&r<=4&&s?"few":s?"other":"many"},cy:function(t){return t==0?"zero":t==1?"one":t==2?"two":t==3?"few":t==6?"many":"other"},da:function(t){var n=String(t).split("."),r=n[0],s=Number(n[0])==t;return t==1||!s&&(r==0||r==1)?"one":"other"},dsb:function(t){var n=String(t).split("."),r=n[0],s=n[1]||"",o=!n[1],c=r.slice(-2),a=s.slice(-2);return o&&c==1||a==1?"one":o&&c==2||a==2?"two":o&&(c==3||c==4)||a==3||a==4?"few":"other"},dz:function(t){return"other"},es:function(t){var n=String(t).split("."),r=n[0],s=!n[1],o=r.slice(-6);return t==1?"one":r!=0&&o==0&&s?"many":"other"},ff:function(t){return t>=0&&t<2?"one":"other"},fr:function(t){var n=String(t).split("."),r=n[0],s=!n[1],o=r.slice(-6);return t>=0&&t<2?"one":r!=0&&o==0&&s?"many":"other"},ga:function(t){var n=String(t).split("."),r=Number(n[0])==t;return t==1?"one":t==2?"two":r&&t>=3&&t<=6?"few":r&&t>=7&&t<=10?"many":"other"},gd:function(t){var n=String(t).split("."),r=Number(n[0])==t;return t==1||t==11?"one":t==2||t==12?"two":r&&t>=3&&t<=10||r&&t>=13&&t<=19?"few":"other"},he:function(t){var n=String(t).split("."),r=n[0],s=!n[1];return r==1&&s||r==0&&!s?"one":r==2&&s?"two":"other"},is:function(t){var n=String(t).split("."),r=n[0],s=(n[1]||"").replace(/0+$/,""),o=Number(n[0])==t,c=r.slice(-1),a=r.slice(-2);return o&&c==1&&a!=11||s%10==1&&s%100!=11?"one":"other"},ksh:function(t){return t==0?"zero":t==1?"one":"other"},lt:function(t){var n=String(t).split("."),r=n[1]||"",s=Number(n[0])==t,o=s&&n[0].slice(-1),c=s&&n[0].slice(-2);return o==1&&(c<11||c>19)?"one":o>=2&&o<=9&&(c<11||c>19)?"few":r!=0?"many":"other"},lv:function(t){var n=String(t).split("."),r=n[1]||"",s=r.length,o=Number(n[0])==t,c=o&&n[0].slice(-1),a=o&&n[0].slice(-2),m=r.slice(-2),h=r.slice(-1);return o&&c==0||a>=11&&a<=19||s==2&&m>=11&&m<=19?"zero":c==1&&a!=11||s==2&&h==1&&m!=11||s!=2&&h==1?"one":"other"},mk:function(t){var n=String(t).split("."),r=n[0],s=n[1]||"",o=!n[1],c=r.slice(-1),a=r.slice(-2),m=s.slice(-1),h=s.slice(-2);return o&&c==1&&a!=11||m==1&&h!=11?"one":"other"},mt:function(t){var n=String(t).split("."),r=Number(n[0])==t,s=r&&n[0].slice(-2);return t==1?"one":t==2?"two":t==0||s>=3&&s<=10?"few":s>=11&&s<=19?"many":"other"},pa:function(t){return t==0||t==1?"one":"other"},pl:function(t){var n=String(t).split("."),r=n[0],s=!n[1],o=r.slice(-1),c=r.slice(-2);return t==1&&s?"one":s&&o>=2&&o<=4&&(c<12||c>14)?"few":s&&r!=1&&(o==0||o==1)||s&&o>=5&&o<=9||s&&c>=12&&c<=14?"many":"other"},pt:function(t){var n=String(t).split("."),r=n[0],s=!n[1],o=r.slice(-6);return r==0||r==1?"one":r!=0&&o==0&&s?"many":"other"},ro:function(t){var n=String(t).split("."),r=!n[1],s=Number(n[0])==t,o=s&&n[0].slice(-2);return t==1&&r?"one":!r||t==0||t!=1&&o>=1&&o<=19?"few":"other"},ru:function(t){var n=String(t).split("."),r=n[0],s=!n[1],o=r.slice(-1),c=r.slice(-2);return s&&o==1&&c!=11?"one":s&&o>=2&&o<=4&&(c<12||c>14)?"few":s&&o==0||s&&o>=5&&o<=9||s&&c>=11&&c<=14?"many":"other"},se:function(t){return t==1?"one":t==2?"two":"other"},si:function(t){var n=String(t).split("."),r=n[0],s=n[1]||"";return t==0||t==1||r==0&&s==1?"one":"other"},sl:function(t){var n=String(t).split("."),r=n[0],s=!n[1],o=r.slice(-2);return s&&o==1?"one":s&&o==2?"two":s&&(o==3||o==4)||!s?"few":"other"}};i.as=i.am;i.az=i.af;i.bg=i.af;i.bn=i.am;i.brx=i.af;i.ce=i.af;i.chr=i.af;i.de=i.ast;i.ee=i.af;i.el=i.af;i.en=i.ast;i.et=i.ast;i.eu=i.af;i.fa=i.am;i.fi=i.ast;i.fil=i.ceb;i.fo=i.af;i.fur=i.af;i.fy=i.ast;i.gl=i.ast;i.gu=i.am;i.ha=i.af;i.hi=i.am;i.hr=i.bs;i.hsb=i.dsb;i.hu=i.af;i.hy=i.ff;i.ia=i.ast;i.id=i.dz;i.ig=i.dz;i.it=i.ca;i.ja=i.dz;i.jgo=i.af;i.jv=i.dz;i.ka=i.af;i.kea=i.dz;i.kk=i.af;i.kl=i.af;i.km=i.dz;i.kn=i.am;i.ko=i.dz;i.ks=i.af;i.ku=i.af;i.ky=i.af;i.lb=i.af;i.lkt=i.dz;i.lo=i.dz;i.ml=i.af;i.mn=i.af;i.mr=i.af;i.ms=i.dz;i.my=i.dz;i.nb=i.af;i.ne=i.af;i.nl=i.ast;i.nn=i.af;i.no=i.af;i.or=i.af;i.pcm=i.am;i.ps=i.af;i.rm=i.af;i.sah=i.dz;i.sc=i.ast;i.sd=i.af;i.sk=i.cs;i.so=i.af;i.sq=i.af;i.sr=i.bs;i.su=i.dz;i.sv=i.ast;i.sw=i.ast;i.ta=i.af;i.te=i.af;i.th=i.dz;i.ti=i.pa;i.tk=i.af;i.to=i.dz;i.tr=i.af;i.ug=i.af;i.uk=i.ru;i.ur=i.ast;i.uz=i.af;i.vi=i.dz;i.wae=i.af;i.wo=i.dz;i.xh=i.af;i.yi=i.ast;i.yo=i.dz;i.yue=i.dz;i.zh=i.dz;i.zu=i.am;const dt=i;function gt(e){return e==="pt-PT"?e:mr(e)}var fr=/^([a-z0-9]+)/i;function mr(e){var t=e.match(fr);if(!t)throw new TypeError("Invalid locale: ".concat(e));return t[1]}function hr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pr(e,t,n){return t&&bt(e.prototype,t),n&&bt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Ae=function(){function e(t,n){hr(this,e);var r=e.supportedLocalesOf(t);if(r.length===0)throw new RangeError("Unsupported locale: "+t);if(n&&n.type!=="cardinal")throw new RangeError('Only "cardinal" "type" is supported');this.$=dt[gt(r[0])]}return pr(e,[{key:"select",value:function(n){return this.$(n)}}],[{key:"supportedLocalesOf",value:function(n){return typeof n=="string"&&(n=[n]),n.filter(function(r){return dt[gt(r)]})}}]),e}();function Le(e){return Le=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Le(e)}function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function yt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_t(Object(n),!0).forEach(function(r){dr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function dr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vt(e,t){return yr(e)||_r(e,t)||br(e,t)||gr()}function gr(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function br(e,t){if(e){if(typeof e=="string")return wt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wt(e,t)}}function wt(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _r(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],s=!0,o=!1,c,a;try{for(n=n.call(e);!(s=(c=n.next()).done)&&(r.push(c.value),!(t&&r.length===t));s=!0);}catch(m){o=!0,a=m}finally{try{!s&&n.return!=null&&n.return()}finally{if(o)throw a}}return r}}function yr(e){if(Array.isArray(e))return e}function vr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wr(e,t,n){return t&&Ot(e.prototype,t),n&&Ot(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Or=["second","minute","hour","day","week","month","quarter","year"],Sr=["auto","always"],$r=["long","short","narrow"],Tr=["lookup","best fit"],F=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};vr(this,e);var r=n.numeric,s=n.style,o=n.localeMatcher;if(this.numeric="always",this.style="long",this.localeMatcher="lookup",r!==void 0){if(Sr.indexOf(r)<0)throw new RangeError('Invalid "numeric" option: '.concat(r));this.numeric=r}if(s!==void 0){if($r.indexOf(s)<0)throw new RangeError('Invalid "style" option: '.concat(s));this.style=s}if(o!==void 0){if(Tr.indexOf(o)<0)throw new RangeError('Invalid "localeMatcher" option: '.concat(o));this.localeMatcher=o}if(typeof t=="string"&&(t=[t]),t.push(an()),this.locale=e.supportedLocalesOf(t,{localeMatcher:this.localeMatcher})[0],!this.locale)throw new Error("No supported locale was found");Ae.supportedLocalesOf(this.locale).length>0?this.pluralRules=new Ae(this.locale):console.warn('"'.concat(this.locale,'" locale is not supported')),typeof Intl<"u"&&Intl.NumberFormat?(this.numberFormat=new Intl.NumberFormat(this.locale),this.numberingSystem=this.numberFormat.resolvedOptions().numberingSystem):this.numberingSystem="latn",this.locale=un(this.locale,{localeMatcher:this.localeMatcher})}return wr(e,[{key:"format",value:function(){var n=St(arguments),r=vt(n,2),s=r[0],o=r[1];return this.getRule(s,o).replace("{0}",this.formatNumber(Math.abs(s)))}},{key:"formatToParts",value:function(){var n=St(arguments),r=vt(n,2),s=r[0],o=r[1],c=this.getRule(s,o),a=c.indexOf("{0}");if(a<0)return[{type:"literal",value:c}];var m=[];return a>0&&m.push({type:"literal",value:c.slice(0,a)}),m=m.concat(this.formatNumberToParts(Math.abs(s)).map(function(h){return yt(yt({},h),{},{unit:o})})),a+3<c.length-1&&m.push({type:"literal",value:c.slice(a+3)}),m}},{key:"getRule",value:function(n,r){var s=cr(this.locale)[this.style][r];if(typeof s=="string")return s;if(this.numeric==="auto"){if(n===-2||n===-1){var o=s["previous".concat(n===-1?"":"-"+Math.abs(n))];if(o)return o}else if(n===1||n===2){var c=s["next".concat(n===1?"":"-"+Math.abs(n))];if(c)return c}else if(n===0&&s.current)return s.current}var a=s[xr(n)?"past":"future"];if(typeof a=="string")return a;var m=this.pluralRules&&this.pluralRules.select(Math.abs(n))||"other";return a[m]||a.other}},{key:"formatNumber",value:function(n){return this.numberFormat?this.numberFormat.format(n):String(n)}},{key:"formatNumberToParts",value:function(n){return this.numberFormat&&this.numberFormat.formatToParts?this.numberFormat.formatToParts(n):[{type:"integer",value:this.formatNumber(n)}]}},{key:"resolvedOptions",value:function(){return{locale:this.locale,style:this.style,numeric:this.numeric,numberingSystem:this.numberingSystem}}}]),e}();F.supportedLocalesOf=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof e=="string")e=[e];else if(!Array.isArray(e))throw new TypeError('Invalid "locales" argument');return e.filter(function(n){return un(n,t)})};F.addLocale=lr;F.setDefaultLocale=ur;F.getDefaultLocale=an;F.PluralRules=Ae;var $e='Invalid "unit" argument';function kr(e){if(Le(e)==="symbol")throw new TypeError($e);if(typeof e!="string")throw new RangeError("".concat($e,": ").concat(e));if(e[e.length-1]==="s"&&(e=e.slice(0,e.length-1)),Or.indexOf(e)<0)throw new RangeError("".concat($e,": ").concat(e));return e}var Cr='Invalid "number" argument';function Pr(e){if(e=Number(e),Number.isFinite&&!Number.isFinite(e))throw new RangeError("".concat(Cr,": ").concat(e));return e}function Er(e){return 1/e===-1/0}function xr(e){return e<0||e===0&&Er(e)}function St(e){if(e.length<2)throw new TypeError('"unit" argument is required');return[Pr(e[0]),kr(e[1])]}function ge(e){return ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge(e)}function Ar(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lr(e,t,n){return t&&$t(e.prototype,t),n&&$t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var Tt=function(){function e(){Ar(this,e),this.cache={}}return Lr(e,[{key:"get",value:function(){for(var n=this.cache,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];for(var c=0,a=s;c<a.length;c++){var m=a[c];if(ge(n)!=="object")return;n=n[m]}return n}},{key:"put",value:function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];for(var o=r.pop(),c=r.pop(),a=this.cache,m=0,h=r;m<h.length;m++){var f=h[m];ge(a[f])!=="object"&&(a[f]={}),a=a[f]}return a[c]=o}}]),e}();function Ne(e){return Ne=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ne(e)}function Nr(e,t){var n=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=jr(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jr(e,t){if(e){if(typeof e=="string")return kt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kt(e,t)}}function kt(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Mr(e,t){for(var n=Nr(e),r;!(r=n()).done;){var s=r.value;if(t(s))return s;for(var o=s.split("-");o.length>1;)if(o.pop(),s=o.join("-"),t(s))return s}throw new Error("No locale data has been registered for any of the locales: ".concat(e.join(", ")))}function Ir(){var e=(typeof Intl>"u"?"undefined":Ne(Intl))==="object";return e&&typeof Intl.DateTimeFormat=="function"}function je(e){return je=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},je(e)}function Rr(e){return Fr(e)&&(Array.isArray(e.steps)||Array.isArray(e.gradation)||Array.isArray(e.flavour)||typeof e.flavour=="string"||Array.isArray(e.labels)||typeof e.labels=="string"||Array.isArray(e.units)||typeof e.custom=="function")}var Dr={}.constructor;function Fr(e){return je(e)!==void 0&&e!==null&&e.constructor===Dr}var R=60,be=60*R,q=24*be,Me=7*q,Ie=30.44*q,cn=146097/400*q;function X(e){switch(e){case"second":return 1;case"minute":return R;case"hour":return be;case"day":return q;case"week":return Me;case"month":return Ie;case"year":return cn}}function ln(e){return e.factor!==void 0?e.factor:X(e.unit||e.formatAs)||1}function ue(e){switch(e){case"floor":return Math.floor;default:return Math.round}}function Be(e){switch(e){case"floor":return 1;default:return .5}}function Re(e){return Re=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Re(e)}function fn(e,t){var n=t.prevStep,r=t.timestamp,s=t.now,o=t.future,c=t.round,a;return n&&(n.id||n.unit)&&(a=e["threshold_for_".concat(n.id||n.unit)]),a===void 0&&e.threshold!==void 0&&(a=e.threshold,typeof a=="function"&&(a=a(s,o))),a===void 0&&(a=e.minTime),Re(a)==="object"&&(n&&n.id&&a[n.id]!==void 0?a=a[n.id]:a=a.default),typeof a=="function"&&(a=a(r,{future:o,getMinTimeForUnit:function(h,f){return Ct(h,f||n&&n.formatAs,{round:c})}})),a===void 0&&e.test&&(e.test(r,{now:s,future:o})?a=0:a=9007199254740991),a===void 0&&(n?e.formatAs&&n.formatAs&&(a=Ct(e.formatAs,n.formatAs,{round:c})):a=0),a===void 0&&console.warn("[javascript-time-ago] A step should specify `minTime`:\n"+JSON.stringify(e,null,2)),a}function Ct(e,t,n){var r=n.round,s=X(e),o;if(t==="now"?o=X(e):o=X(t),s!==void 0&&o!==void 0)return s-o*(1-Be(r))}function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function Ur(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Pt(Object(n),!0).forEach(function(r){zr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function zr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qr(e,t,n){var r=n.now,s=n.future,o=n.round,c=n.units,a=n.getNextStep;e=Hr(e,c);var m=Jr(e,t,{now:r,future:s,round:o});if(a){if(m){var h=e[e.indexOf(m)-1],f=e[e.indexOf(m)+1];return[h,m,f]}return[void 0,void 0,e[0]]}return m}function Jr(e,t,n){var r=n.now,s=n.future,o=n.round;if(e.length!==0){var c=mn(e,t,{now:r,future:s||t<0,round:o});if(c!==-1){var a=e[c];if(a.granularity){var m=ue(o)(Math.abs(t)/ln(a)/a.granularity)*a.granularity;if(m===0&&c>0)return e[c-1]}return a}}}function mn(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=fn(e[r],Ur({prevStep:e[r-1],timestamp:n.now-t*1e3},n));return s===void 0||Math.abs(t)<s?r-1:r===e.length-1?r:mn(e,t,n,r+1)}function Hr(e,t){return e.filter(function(n){var r=n.unit,s=n.formatAs;return r=r||s,r?t.indexOf(r)>=0:!0})}function Vr(e,t,n){var r=n.now,s=n.round;if(X(e)){var o=X(e)*1e3,c=t>r,a=Math.abs(t-r),m=ue(s)(a/o)*o;return c?m>0?a-m+Wr(s,o):a-m+1:-(a-m)+Gr(s,o)}}function Gr(e,t){return Be(e)*t}function Wr(e,t){return(1-Be(e))*t+1}var Br=365*24*60*60*1e3,hn=1e3*Br;function Kr(e,t,n){var r=n.prevStep,s=n.nextStep,o=n.now,c=n.future,a=n.round,m=e.getTime?e.getTime():e,h=function(l){return Vr(l,m,{now:o,round:a})},f=Qr(c?t:s,m,{future:c,now:o,round:a,prevStep:c?r:t});if(f!==void 0){var w;if(t&&(t.getTimeToNextUpdate&&(w=t.getTimeToNextUpdate(m,{getTimeToNextUpdateForUnit:h,getRoundFunction:ue,now:o,future:c,round:a})),w===void 0)){var b=t.unit||t.formatAs;b&&(w=h(b))}return w===void 0?f:Math.min(w,f)}}function Yr(e,t,n){var r=n.now,s=n.future,o=n.round,c=n.prevStep,a=fn(e,{timestamp:t,now:r,future:s,round:o,prevStep:c});if(a!==void 0)return s?t-a*1e3+1:a===0&&t===r?hn:t+a*1e3}function Qr(e,t,n){var r=n.now,s=n.future,o=n.round,c=n.prevStep;if(e){var a=Yr(e,t,{now:r,future:s,round:o,prevStep:c});return a===void 0?void 0:a-r}else return s?t-r+1:hn}var pn={};function Y(e){return pn[e]}function dn(e){if(!e)throw new Error("[javascript-time-ago] No locale data passed.");pn[e.locale]=e}const Xr=[{formatAs:"now"},{formatAs:"second"},{formatAs:"minute"},{formatAs:"hour"},{formatAs:"day"},{formatAs:"week"},{formatAs:"month"},{formatAs:"year"}],De={steps:Xr,labels:"long"};function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function xt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Et(Object(n),!0).forEach(function(r){Zr(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Zr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Fe=xt(xt({},De),{},{steps:De.steps.filter(function(e){return e.formatAs!=="second"})}),gn=[{factor:1,unit:"now"},{threshold:1,threshold_for_now:45.5,factor:1,unit:"second"},{threshold:45.5,factor:R,unit:"minute"},{threshold:2.5*R,granularity:5,factor:R,unit:"minute"},{threshold:22.5*R,factor:.5*be,unit:"half-hour"},{threshold:42.5*R,threshold_for_minute:52.5*R,factor:be,unit:"hour"},{threshold:20.5/24*q,factor:q,unit:"day"},{threshold:5.5*q,factor:Me,unit:"week"},{threshold:3.5*Me,factor:Ie,unit:"month"},{threshold:10.5*Ie,factor:cn,unit:"year"}],At={gradation:gn,flavour:"long",units:["now","minute","hour","day","week","month","year"]},es={gradation:gn,flavour:"long-time",units:["now","minute","hour","day","week","month","year"]};function bn(e){return e instanceof Date?e:new Date(e)}var Ue=[{formatAs:"second"},{formatAs:"minute"},{formatAs:"hour"}],I={},ts={minTime:function(t,n){n.future;var r=n.getMinTimeForUnit;return r("day")},format:function(t,n){return I[n]||(I[n]={}),I[n].dayMonth||(I[n].dayMonth=new Intl.DateTimeFormat(n,{month:"short",day:"numeric"})),I[n].dayMonth.format(bn(t))}},ns={minTime:function(t,n){var r=n.future;if(r){var s=new Date(new Date(t).getFullYear(),0).getTime()-1;return(t-s)/1e3}else{var o=new Date(new Date(t).getFullYear()+1,0).getTime();return(o-t)/1e3}},format:function(t,n){return I[n]||(I[n]={}),I[n].dayMonthYear||(I[n].dayMonthYear=new Intl.DateTimeFormat(n,{year:"numeric",month:"short",day:"numeric"})),I[n].dayMonthYear.format(bn(t))}};Ir()?Ue.push(ts,ns):Ue.push({formatAs:"day"},{formatAs:"week"},{formatAs:"month"},{formatAs:"year"});const J={steps:Ue,labels:["mini","short-time","narrow","short"]};function Lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function Nt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Lt(Object(n),!0).forEach(function(r){rs(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function rs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ss=Nt(Nt({},J),{},{steps:[{formatAs:"now"}].concat(J.steps)});function jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function Mt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jt(Object(n),!0).forEach(function(r){os(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function os(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ze=Mt(Mt({},J),{},{steps:J.steps.filter(function(e){return e.formatAs!=="second"})});function It(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?It(Object(n),!0).forEach(function(r){is(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function is(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const as=Rt(Rt({},ze),{},{steps:[{formatAs:"now"}].concat(ze.steps)});function Dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Dt(Object(n),!0).forEach(function(r){us(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function us(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const cs=pe(pe({},J),{},{steps:J.steps.filter(function(e){return e.formatAs!=="second"}).map(function(e){return e.formatAs==="minute"?pe(pe({},e),{},{minTime:R}):e})}),ce={steps:[{formatAs:"second"},{formatAs:"minute"},{formatAs:"hour"},{formatAs:"day"},{formatAs:"month"},{formatAs:"year"}],labels:["mini","short-time","narrow","short"]};function Ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function Ut(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ft(Object(n),!0).forEach(function(r){ls(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ft(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ls(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const fs=Ut(Ut({},ce),{},{steps:[{formatAs:"now"}].concat(ce.steps)});function zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function qt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zt(Object(n),!0).forEach(function(r){ms(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ms(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const qe=qt(qt({},ce),{},{steps:ce.steps.filter(function(e){return e.formatAs!=="second"})});function Jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function Ht(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Jt(Object(n),!0).forEach(function(r){hs(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function hs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ps=Ht(Ht({},qe),{},{steps:[{formatAs:"now"}].concat(qe.steps)});function ds(e){switch(e){case"default":case"round":return De;case"round-minute":return Fe;case"approximate":return At;case"time":case"approximate-time":return es;case"mini":return ce;case"mini-now":return fs;case"mini-minute":return qe;case"mini-minute-now":return ps;case"twitter":return J;case"twitter-now":return ss;case"twitter-minute":return ze;case"twitter-minute-now":return as;case"twitter-first-minute":return cs;default:return At}}function _e(e){return _e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_e(e)}function gs(e,t){var n=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=_n(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bs(e,t){return vs(e)||ys(e,t)||_n(e,t)||_s()}function _s(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _n(e,t){if(e){if(typeof e=="string")return Vt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vt(e,t)}}function Vt(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ys(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],s=!0,o=!1,c,a;try{for(n=n.call(e);!(s=(c=n.next()).done)&&(r.push(c.value),!(t&&r.length===t));s=!0);}catch(m){o=!0,a=m}finally{try{!s&&n.return!=null&&n.return()}finally{if(o)throw a}}return r}}function vs(e){if(Array.isArray(e))return e}function ws(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Os(e,t,n){return t&&Gt(e.prototype,t),n&&Gt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var M=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=n.polyfill;ws(this,e),typeof t=="string"&&(t=[t]),this.locale=Mr(t.concat(e.getDefaultLocale()),Y),typeof Intl<"u"&&Intl.NumberFormat&&(this.numberFormat=new Intl.NumberFormat(this.locale)),r===!1?(this.IntlRelativeTimeFormat=Intl.RelativeTimeFormat,this.IntlPluralRules=Intl.PluralRules):(this.IntlRelativeTimeFormat=F,this.IntlPluralRules=F.PluralRules),this.relativeTimeFormatCache=new Tt,this.pluralRulesCache=new Tt}return Os(e,[{key:"format",value:function(n,r,s){s||(r&&!Cs(r)?(s=r,r=void 0):s={}),r||(r=Fe),typeof r=="string"&&(r=ds(r));var o=Ss(n),c=this.getLabels(r.flavour||r.labels),a=c.labels,m=c.labelsType,h;r.now!==void 0&&(h=r.now),h===void 0&&s.now!==void 0&&(h=s.now),h===void 0&&(h=Date.now());var f=(h-o)/1e3,w=s.future||f<0,b=ks(a,Y(this.locale).now,Y(this.locale).long,w);if(r.custom){var y=r.custom({now:h,date:new Date(o),time:o,elapsed:f,locale:this.locale});if(y!==void 0)return y}var l=Ts(r.units,a,b),u=s.round||r.round,p=qr(r.gradation||r.steps||Fe.steps,f,{now:h,units:l,round:u,future:w,getNextStep:!0}),O=bs(p,3),_=O[0],d=O[1],g=O[2],$=this.formatDateForStep(o,d,f,{labels:a,labelsType:m,nowLabel:b,now:h,future:w,round:u})||"";if(s.getTimeToNextUpdate){var E=Kr(o,d,{nextStep:g,prevStep:_,now:h,future:w,round:u});return[$,E]}return $}},{key:"formatDateForStep",value:function(n,r,s,o){var c=this,a=o.labels,m=o.labelsType,h=o.nowLabel,f=o.now,w=o.future,b=o.round;if(r){if(r.format)return r.format(n,this.locale,{formatAs:function(O,_){return c.formatValue(_,O,{labels:a,future:w})},now:f,future:w});var y=r.unit||r.formatAs;if(!y)throw new Error("[javascript-time-ago] Each step must define either `formatAs` or `format()`. Step: ".concat(JSON.stringify(r)));if(y==="now")return h;var l=Math.abs(s)/ln(r);r.granularity&&(l=ue(b)(l/r.granularity)*r.granularity);var u=-1*Math.sign(s)*ue(b)(l);switch(u===0&&(w?u=0:u=-0),m){case"long":case"short":case"narrow":return this.getFormatter(m).format(u,y);default:return this.formatValue(u,y,{labels:a,future:w})}}}},{key:"formatValue",value:function(n,r,s){var o=s.labels,c=s.future;return this.getFormattingRule(o,r,n,{future:c}).replace("{0}",this.formatNumber(Math.abs(n)))}},{key:"getFormattingRule",value:function(n,r,s,o){var c=o.future;if(this.locale,n=n[r],typeof n=="string")return n;var a=s===0?c?"future":"past":s<0?"past":"future",m=n[a]||n;if(typeof m=="string")return m;var h=this.getPluralRules().select(Math.abs(s));return m[h]||m.other}},{key:"formatNumber",value:function(n){return this.numberFormat?this.numberFormat.format(n):String(n)}},{key:"getFormatter",value:function(n){return this.relativeTimeFormatCache.get(this.locale,n)||this.relativeTimeFormatCache.put(this.locale,n,new this.IntlRelativeTimeFormat(this.locale,{style:n}))}},{key:"getPluralRules",value:function(){return this.pluralRulesCache.get(this.locale)||this.pluralRulesCache.put(this.locale,new this.IntlPluralRules(this.locale))}},{key:"getLabels",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];typeof n=="string"&&(n=[n]),n=n.map(function(a){switch(a){case"tiny":case"mini-time":return"mini";default:return a}}),n=n.concat("long");for(var r=Y(this.locale),s=gs(n),o;!(o=s()).done;){var c=o.value;if(r[c])return{labelsType:c,labels:r[c]}}}}]),e}(),yn="en";M.getDefaultLocale=function(){return yn};M.setDefaultLocale=function(e){return yn=e};M.addDefaultLocale=function(e){if(Wt)return console.error("[javascript-time-ago] `TimeAgo.addDefaultLocale()` can only be called once. To add other locales, use `TimeAgo.addLocale()`.");Wt=!0,M.setDefaultLocale(e.locale),M.addLocale(e)};var Wt;M.addLocale=function(e){dn(e),F.addLocale(e)};M.locale=M.addLocale;M.addLabels=function(e,t,n){var r=Y(e);r||(dn({locale:e}),r=Y(e)),r[t]=n};function Ss(e){if(e.constructor===Date||$s(e))return e.getTime();if(typeof e=="number")return e;throw new Error("Unsupported relative time formatter input: ".concat(_e(e),", ").concat(e))}function $s(e){return _e(e)==="object"&&typeof e.getTime=="function"}function Ts(e,t,n){var r=Object.keys(t);return n&&r.push("now"),e&&(r=e.filter(function(s){return s==="now"||r.indexOf(s)>=0})),r}function ks(e,t,n,r){var s=e.now||t&&t.now;if(s)return typeof s=="string"?s:r?s.future:s.past;if(n&&n.second&&n.second.current)return n.second.current}function Cs(e){return typeof e=="string"||Rr(e)}const Ps={locale:"es",long:{year:{previous:"el ao pasado",current:"este ao",next:"el prximo ao",past:{one:"hace {0} ao",other:"hace {0} aos"},future:{one:"dentro de {0} ao",other:"dentro de {0} aos"}},quarter:{previous:"el trimestre pasado",current:"este trimestre",next:"el prximo trimestre",past:{one:"hace {0} trimestre",other:"hace {0} trimestres"},future:{one:"dentro de {0} trimestre",other:"dentro de {0} trimestres"}},month:{previous:"el mes pasado",current:"este mes",next:"el prximo mes",past:{one:"hace {0} mes",other:"hace {0} meses"},future:{one:"dentro de {0} mes",other:"dentro de {0} meses"}},week:{previous:"la semana pasada",current:"esta semana",next:"la prxima semana",past:{one:"hace {0} semana",other:"hace {0} semanas"},future:{one:"dentro de {0} semana",other:"dentro de {0} semanas"}},day:{previous:"ayer","previous-2":"anteayer",current:"hoy",next:"maana","next-2":"pasado maana",past:{one:"hace {0} da",other:"hace {0} das"},future:{one:"dentro de {0} da",other:"dentro de {0} das"}},hour:{current:"esta hora",past:{one:"hace {0} hora",other:"hace {0} horas"},future:{one:"dentro de {0} hora",other:"dentro de {0} horas"}},minute:{current:"este minuto",past:{one:"hace {0} minuto",other:"hace {0} minutos"},future:{one:"dentro de {0} minuto",other:"dentro de {0} minutos"}},second:{current:"ahora",past:{one:"hace {0} segundo",other:"hace {0} segundos"},future:{one:"dentro de {0} segundo",other:"dentro de {0} segundos"}}},short:{year:{previous:"el ao pasado",current:"este ao",next:"el prximo ao",past:"hace {0} a",future:"dentro de {0} a"},quarter:{previous:"el trimestre pasado",current:"este trimestre",next:"el prximo trimestre",past:"hace {0} trim.",future:"dentro de {0} trim."},month:{previous:"el mes pasado",current:"este mes",next:"el prximo mes",past:"hace {0} m",future:"dentro de {0} m"},week:{previous:"sem. ant.",current:"esta sem.",next:"prx. sem.",past:"hace {0} sem.",future:"dentro de {0} sem."},day:{previous:"ayer","previous-2":"anteayer",current:"hoy",next:"maana","next-2":"pasado maana",past:"hace {0} d",future:"dentro de {0} d"},hour:{current:"esta hora",past:"hace {0} h",future:"dentro de {0} h"},minute:{current:"este minuto",past:"hace {0} min",future:"dentro de {0} min"},second:{current:"ahora",past:"hace {0} s",future:"dentro de {0} s"}},narrow:{year:{previous:"el ao pasado",current:"este ao",next:"el prximo ao",past:"hace {0} a",future:"dentro de {0} a"},quarter:{previous:"el trimestre pasado",current:"este trimestre",next:"el prximo trimestre",past:"hace {0} trim.",future:"dentro de {0} trim."},month:{previous:"el mes pasado",current:"este mes",next:"el prximo mes",past:"hace {0} m",future:"dentro de {0} m"},week:{previous:"sem. ant.",current:"esta sem.",next:"prx. sem.",past:"hace {0} sem.",future:"dentro de {0} sem."},day:{previous:"ayer","previous-2":"anteayer",current:"hoy",next:"maana","next-2":"pasado maana",past:"hace {0} d",future:"dentro de {0} d"},hour:{current:"esta hora",past:"hace {0} h",future:"dentro de {0} h"},minute:{current:"este minuto",past:"hace {0} min",future:"dentro de {0} min"},second:{current:"ahora",past:"hace {0} s",future:"dentro de {0} s"}},now:{now:{current:"ahora",future:"enseguida",past:"ahora mismo"}},mini:{year:{one:"{0} ao",other:"{0} aos"},month:{one:"{0} mes",other:"{0} meses"},week:"{0} sem.",day:{one:"{0} da",other:"{0} das"},hour:{one:"{0} hora",other:"{0} horas"},minute:"{0} min.",second:"{0} seg.",now:"ahora"},"long-time":{year:{one:"{0} ao",other:"{0} aos"},month:{one:"{0} mes",other:"{0} meses"},week:{one:"{0} semana",other:"{0} semanas"},day:{one:"{0} da",other:"{0} das"},hour:{one:"{0} hora",other:"{0} horas"},minute:{one:"{0} minuto",other:"{0} minutos"},second:{one:"{0} segundo",other:"{0} segundos"}}};function Es(e,t,n){return"https://static-cdn.jtvnw.net/emoticons/v2/{{id}}/default/{{theme_mode}}/{{scale}}".replace("{{id}}",e).replace("{{theme_mode}}",t).replace("{{scale}}",n)}function Bt(e){const{message:t,emotes:n}=e;let r=t;return n==null?t:(Object.entries(n).forEach(([s,o])=>{const c=Es(s,"dark","3.0");o.forEach(a=>{const[m,h]=a.split("-").map(b=>parseInt(b)),f=t.substring(m,h+1),w=`<img src="${c}" style="height: 1em;">`;r=r.replace(f,w)})}),r)}function xs(e){let t,n,r=e[0].user+"",s,o,c,a,m=Bt(e[0])+"",h,f,w,b,y,l;return{c(){t=L("div"),n=L("p"),s=se(r),c=ne(),a=L("div"),h=ne(),f=L("p"),w=L("time"),b=se(e[1]),P(n,"class","sender svelte-149k8nq"),P(n,"data-color",o=e[0].userColor),Qe(n,"--color",e[0].userColor),P(a,"class","message-content svelte-149k8nq"),P(w,"datetime",e[2]),P(f,"class","ago svelte-149k8nq"),P(t,"class","root svelte-149k8nq"),P(t,"data-uuid",y=e[0].uuid),P(t,"data-user",l=e[0].user)},m(u,p){le(u,t,p),x(t,n),x(n,s),x(t,c),x(t,a),a.innerHTML=m,x(t,h),x(t,f),x(f,w),x(w,b)},p(u,[p]){p&1&&r!==(r=u[0].user+"")&&Te(s,r),p&1&&o!==(o=u[0].userColor)&&P(n,"data-color",o),p&1&&Qe(n,"--color",u[0].userColor),p&1&&m!==(m=Bt(u[0])+"")&&(a.innerHTML=m),p&2&&Te(b,u[1]),p&1&&y!==(y=u[0].uuid)&&P(t,"data-uuid",y),p&1&&l!==(l=u[0].user)&&P(t,"data-user",l)},i:N,o:N,d(u){u&&te(t)}}}function As(e,t,n){let{message:r}=t,s=new Date(r.datetime).toISOString();M.addDefaultLocale(Ps);const o=new M("es");function c(h){let f=o.format(h,"round");return Date.now()-h>5*60*1e3&&(f=f+" "),f}let a=c(r.datetime),m;return Xt(()=>{m=setInterval(()=>{n(1,a=c(r.datetime))},1e3)}),kn(()=>{clearInterval(m)}),e.$$set=h=>{"message"in h&&n(0,r=h.message)},[r,a,s]}class Ls extends Ge{constructor(t){super(),Ve(this,t,As,xs,ye,{message:0})}}const Ns={"*quack*":""};class js{constructor(t,n){me(this,"messages",[]);me(this,"muted");me(this,"voice");this.voice=window.speechSynthesis.getVoices().find(r=>r.name==t&&r.lang==n)}pushMessage(t){let n=t;Object.entries(Ns).forEach(r=>{const[s,o]=r;n=n.replace(s,o)}),window.speechSynthesis.speaking||this.speakNext()}speakNext(){if(this.messages.length===0)return;const t=this.messages.pop(),n=new SpeechSynthesisUtterance(t);n.voice=this.voice,n.addEventListener("end",()=>{this.speakNext()}),window.speechSynthesis.speak(n)}}function Ms(e){let t;return{c(){t=L("p"),t.textContent="Al da ",P(t,"class","no-messages svelte-1oilj9r")},m(n,r){le(n,t,r)},p:N,i:N,o:N,d(n){n&&te(t)}}}function Is(e){let t,n;return t=new Ls({props:{message:e[1].messages[0]}}),{c(){en(t.$$.fragment)},m(r,s){Je(t,r,s),n=!0},p(r,s){const o={};s&2&&(o.message=r[1].messages[0]),t.$set(o)},i(r){n||(Z(t.$$.fragment,r),n=!0)},o(r){ie(t.$$.fragment,r),n=!1},d(r){He(t,r)}}}function Rs(e){let t,n,r,s,o,c=e[1].messages.length+"",a,m,h,f,w,b,y,l,u,p,O,_,d;const g=[Is,Ms],$=[];function E(T,C){return T[1].messages[0]?0:1}return h=E(e),f=$[h]=g[h](e),{c(){t=L("div"),n=L("div"),r=L("p"),s=L("strong"),o=se("Mensajes en cola: "),a=se(c),m=ne(),f.c(),w=ne(),b=L("div"),y=L("p"),l=L("button"),l.textContent="Pasar al siguiente",u=ne(),p=L("button"),p.textContent="Limpiar cola",P(r,"class","queue-length"),P(n,"class","queue-length-block svelte-1oilj9r"),P(y,"class","buttons"),P(b,"class","buttons-block svelte-1oilj9r"),P(t,"class","container"),P(t,"data-channel",e[0])},m(T,C){le(T,t,C),x(t,n),x(n,r),x(r,s),x(s,o),x(s,a),x(t,m),$[h].m(t,null),x(t,w),x(t,b),x(b,y),x(y,l),x(y,u),x(y,p),O=!0,_||(d=[Ye(l,"click",e[2]),Ye(p,"click",e[3])],_=!0)},p(T,[C]){(!O||C&2)&&c!==(c=T[1].messages.length+"")&&Te(a,c);let k=h;h=E(T),h===k?$[h].p(T,C):(An(),ie($[k],1,1,()=>{$[k]=null}),Ln(),f=$[h],f?f.p(T,C):(f=$[h]=g[h](T),f.c()),Z(f,1),f.m(t,w)),(!O||C&1)&&P(t,"data-channel",T[0])},i(T){O||(Z(f),O=!0)},o(T){ie(f),O=!1},d(T){T&&te(t),$[h].d(),_=!1,ee(d)}}}function Ds(e,t,n){let r;$n(e,B,h=>n(1,r=h));let{channelName:s}=t,o=new js("Jorge","es-ES"),c=new rr.Client({channels:[s]});c.on("message",(h,f,w,b)=>{console.log("message",{channel:h,tags:f,message:w,self:b}),w.includes("http://")||w.includes("https://")?o.pushMessage(`${f["display-name"]} ha enviado un link`):o.pushMessage(w),B.update(y=>or(y,{datetime:parseInt(f["tmi-sent-ts"]),emotes:f.emotes,message:w,user:f["display-name"],userColor:f.color,uuid:f.id}))}),c.on("messagedeleted",(h,f,w,b)=>{console.log("messagedeleted",{channel:h,username:f,deletedMessage:w,userstate:b}),B.update(y=>ar(y,b["target-msg-id"]))}),c.on("clearchat",h=>{console.log("clearchat",{channel:h}),B.update(f=>Ee())}),Xt(()=>{c.connect()});const a=()=>{B.update(h=>ir(h))},m=()=>{B.update(h=>Ee())};return e.$$set=h=>{"channelName"in h&&n(0,s=h.channelName)},[s,r,a,m]}class Fs extends Ge{constructor(t){super(),Ve(this,t,Ds,Rs,ye,{channelName:0})}}function Us(e){let t;return{c(){t=L("form"),t.innerHTML=`<input type="text" name="channel" placeholder="Nombre de canal"/> 
      <button type="submit">Ver</button>`,P(t,"method","GET"),P(t,"action",".")},m(n,r){le(n,t,r)},p:N,i:N,o:N,d(n){n&&te(t)}}}function zs(e){let t,n;return t=new Fs({props:{channelName:e[0]}}),{c(){en(t.$$.fragment)},m(r,s){Je(t,r,s),n=!0},p:N,i(r){n||(Z(t.$$.fragment,r),n=!0)},o(r){ie(t.$$.fragment,r),n=!1},d(r){He(t,r)}}}function qs(e){let t,n,r,s;const o=[zs,Us],c=[];function a(m,h){return m[0]?0:1}return n=a(e),r=c[n]=o[n](e),{c(){t=L("main"),r.c()},m(m,h){le(m,t,h),c[n].m(t,null),s=!0},p(m,[h]){r.p(m,h)},i(m){s||(Z(r),s=!0)},o(m){ie(r),s=!1},d(m){m&&te(t),c[n].d()}}}function Js(e){let t=window.location.href;return[new URL(t).searchParams.get("channel")]}class Hs extends Ge{constructor(t){super(),Ve(this,t,Js,qs,ye,{})}}new Hs({target:document.getElementById("app")});
